{% extends 'accounts/base.html' %}
{% block body %}

<table>
    <thead> <!-- table head!!!! 코드 바뀌는 거는 아니고 의미상 묶어준것-->
        <tr> <!-- table row(행) -->
          <th></th> <!-- table header -->
          <th>
              <img src="https://image.tmdb.org/t/p/w185_and_h278_bestv2/{{ movie.poster_path }}" alt="{{ movie.title }}" style="width:25vw; margin-right: 20px;"></th> <!-- font-wieght: bold 적용-->
          <th><h1>{{ movie.title }}</h1>
            <hr>
            <p>관객수: {{ movie.popularity }}십만 명</p>
            <p>장르: {{ movie.genre.name}}</p>
            <p>줄거리: {{ movie.overview }}</p></th>
        </tr>
      </thead>
</table>
<hr>

{% if user.is_authenticated %}
    <form action="{% url 'movies:like' movie.pk %}" method="POST">
        {% csrf_token %}
        <button type="submit">좋아요
        {% if movie in user.like_movies.all %}
        {% endif %}
        ({{ movie.like_users.count }})
        </button>
    </form>
{% endif %}

<p><span id="like-count">{{ movie.like_users.count }}</span>명이 이 글을 좋아합니다.</p>
  {% if user in movie.like_users.all %}
  <a>
  <i id="like-button" data-id="{{movie.id}}" class="fas fa-heart fa-2x" style="color: red;"></i>
  
  {% else %}
  <i id="like-button" data-id="{{movie.id}}" class="far fa-heart fa-2x" style="color: black;"></i>
  {% endif %}

<hr>
{% for rating in movie.rating_set.all %}
    <p><a href="{% url 'accounts:detail' rating.user.pk %}">{{ rating.user.username }}</a>: {{ rating.content }} ({{ rating.score }}점)</p>
    <form action="{% url 'movies:rating_delete' movie.pk rating.pk %}" method="POST" onclick="return confirm('삭제하시겠습니까?')">
        {% csrf_token %}
        <button type="submit">삭제</button>
    </form>
{% empty %}
    <p>등록된 평점이 없습니다.</p>
{% endfor %}

{% if user.is_authenticated %}
    <form action="{% url 'movies:rating_create' movie.pk %}" method="POST">
        {% csrf_token %}
        {{ form.as_p }}
        <button type="submit">확인</button>
    </form>
{% endif %}
{% endblock %}
